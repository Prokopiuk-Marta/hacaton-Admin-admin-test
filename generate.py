import os
import json
import random
import time
from dotenv import load_dotenv
from typing import Literal
from pydantic import BaseModel, Field
from concurrent.futures import ThreadPoolExecutor

from google import genai
from google.genai import types

load_dotenv()
api_key = os.getenv("GEMINI_API_KEY")

if not api_key:
    raise ValueError("–ö–ª—é—á GEMINI_API_KEY –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!")

client = genai.Client(api_key=api_key)

class Message(BaseModel):
    role: Literal["–ö–ª—ñ—î–Ω—Ç", "–û–ø–µ—Ä–∞—Ç–æ—Ä"] = Field(
        description="–†–æ–ª—å —É—á–∞—Å–Ω–∏–∫–∞: —Å—É–≤–æ—Ä–æ '–ö–ª—ñ—î–Ω—Ç' –∞–±–æ '–û–ø–µ—Ä–∞—Ç–æ—Ä'."
    )
    text: str = Field(
        description="–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: —ñ–º–µ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –¢–Ü–õ–¨–ö–ò —Ç—É—Ç."
    )


class DialogueResponse(BaseModel):
    dialogue: list[Message]

intents = [
    "–ø—Ä–æ–±–ª–µ–º–∏ –∑ –æ–ø–ª–∞—Ç–æ—é",
    "—Ç–µ—Ö–Ω—ñ—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏",
    "–¥–æ—Å—Ç—É–ø –¥–æ –∞–∫–∞—É–Ω—Ç—É",
    "–ø–∏—Ç–∞–Ω–Ω—è –ø–æ —Ç–∞—Ä–∏—Ñ—É",
    "–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–æ—à—Ç—ñ–≤",
    "–∑–º—ñ–Ω–∞ –æ—Å–æ–±–∏—Å—Ç–∏—Ö –¥–∞–Ω–∏—Ö"
]

scenario_instructions = {
    "successful_case": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –û–ø–µ—Ä–∞—Ç–æ—Ä –¥—ñ—î –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ, —à–≤–∏–¥–∫–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —Ä—ñ—à–µ–Ω–Ω—è.
        –ö–ª—ñ—î–Ω—Ç: –°–ø–æ—á–∞—Ç–∫—É —Å—Ç—É—Ä–±–æ–≤–∞–Ω–∏–π, –∞–ª–µ –≤ –∫—ñ–Ω—Ü—ñ —â–∏—Ä–æ –¥—è–∫—É—î —ñ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∏–π —Å–µ—Ä–≤—ñ—Å–æ–º.
        –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–æ–±–ª–µ–º–∞ –≤–∏—Ä—ñ—à–µ–Ω–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é. 
        
        –ø—Ä–∏–∫–ª–∞–¥ –∑ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—é: –ö–ª—ñ—î–Ω—Ç —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è –≥—Ä—É–±—É–≤–∞—Ç–æ —ñ —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–æ –∑ —Å–∞–º–æ–≥–æ –ø–æ—á–∞—Ç–∫—É, –Ω–µ 
        –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–ª–æ–≤–∞ ¬´–¥—è–∫—É—é¬ª —á–∏ ¬´—Å—É–ø–µ—Ä¬ª —É –∫—ñ–Ω—Ü—ñ, –∞–ª–µ –π–æ–≥–æ –ø—Ä–æ–±–ª–µ–º–∞ –±—É–ª–∞ –≤–∏—Ä—ñ—à–µ–Ω–∞ –º–∏—Ç—Ç—î–≤–æ, —ñ –≤—ñ–Ω 
        –≤–∏–∑–Ω–∞–≤ –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞. –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è:
        –ö–ª—ñ—î–Ω—Ç: –ù—É —ñ –¥–æ–≤–≥–æ –≤–∞—à —Å–∞–π—Ç –±—É–¥–µ –ª–µ–∂–∞—Ç–∏? –Ø –≤–∂–µ —Ç—Ä–µ—Ç—é —Å–ø—Ä–æ–±—É —Ä–æ–±–ª—é –æ–ø–ª–∞—Ç–∏—Ç–∏ –∫–æ—à–∏–∫, –≤–æ–Ω–æ 
        –ø—Ä–æ—Å—Ç–æ –∫—Ä—É—Ç–∏—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ –Ω—É–ª—å —Ä–µ–∞–∫—Ü—ñ—ó.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–æ–±—Ä–∏–π –¥–µ–Ω—å, –ú–∞–∫—Å–∏–º–µ! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. –ë–∞—á—É, —â–æ –≤–∏ –∑—ñ—Ç–∫–Ω—É–ª–∏—Å—è –∑ –ø—Ä–æ–±–ª–µ–º–æ—é 
        –ø—Ä–∏ –æ–ø–ª–∞—Ç—ñ. –ó–∞—Ä–∞–∑ –ø–µ—Ä–µ–≤—ñ—Ä—é –ª–æ–≥–∏ –≤–∞—à–æ—ó —Å–µ—Å—ñ—ó, —Ö–≤–∏–ª–∏–Ω—É.
        
        –ö–ª—ñ—î–Ω—Ç: –î–∞–≤–∞–π—Ç–µ, –±–æ –≤–∂–µ –±–∞–∂–∞–Ω–Ω—è —â–æ—Å—å –∫—É–ø—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–∞–¥–∞—î.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ó–Ω–∞–π—à–æ–≤ –ø–æ–º–∏–ª–∫—É. –í–∞—à–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—è —Å–µ—Å—ñ—è –æ–ø–ª–∞—Ç–∏ –∑–∞–≤–∏—Å–ª–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –ø–ª–∞—Ç—ñ–∂–Ω–æ–≥–æ —à–ª—é–∑—É, 
        —ñ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –¥–∞–≤–∞–ª–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É. –Ø –≤—Ä—É—á–Ω—É —Å–∫–∏–Ω—É–≤ —Ü–µ–π —Å—Ç–∞—Ç—É—Å. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–∞–∑, –º–∞—î –ø—Ä–æ–π—Ç–∏ –º–∏—Ç—Ç—î–≤–æ.
        
        –ö–ª—ñ—î–Ω—Ç: –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–π—à–ª–∞. –ù–∞—Ä–µ—à—Ç—ñ —Ö—Ç–æ—Å—å –∑ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º–∏ —Ä—É–∫–∞–º–∏, –∞ –Ω–µ —Å–∫—Ä–∏–ø—Ç–æ—á–∏—Ç–∞–ª–∫–∏. –¢—ñ–∫–µ—Ç –º–æ–∂–Ω–∞ 
        –∑–∞–∫—Ä–∏–≤–∞—Ç–∏.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ó–∞–≤–∂–¥–∏ —Ä–∞–¥–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏! –°–ø–æ–∫—ñ–π–Ω–æ–≥–æ –≤–∞–º –¥–Ω—è.
    """,
    "hidden_dissatisfaction": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –û–ø–µ—Ä–∞—Ç–æ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —à–∞–±–ª–æ–Ω–Ω–æ –∞–±–æ –Ω–µ –∑–∞–≥–ª–∏–±–ª—é—î—Ç—å—Å—è –≤ —Å—É—Ç—å.
        –ö–ª—ñ—î–Ω—Ç: –§–æ—Ä–º–∞–ª—å–Ω–æ –≤–≤—ñ—á–ª–∏–≤–∏–π, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ö–æ–ª–æ–¥–Ω—ñ —Ñ—Ä–∞–∑–∏ ('–∑—Ä–æ–∑—É–º—ñ–ª–æ', '–Ω—É –¥–æ–±—Ä–µ', '—è –ø–æ—á—É–≤').
        –í–ê–ñ–õ–ò–í–û: –ö–ª—ñ—î–Ω—Ç –ù–ï –∫–∞–∂–µ –ø—Ä—è–º–æ, —â–æ –≤—ñ–Ω –Ω–µ–∑–∞–¥–æ–≤–æ–ª–µ–Ω–∏–π, –∞–ª–µ –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤–∏–¥–Ω–æ, —â–æ –≤—ñ–Ω –ø—Ä–æ—Å—Ç–æ –∑–¥–∞–≤—Å—è.
        –§—ñ–Ω–∞–ª: –ö–ª—ñ—î–Ω—Ç –ø—Ä–∏–ø–∏–Ω—è—î –¥—ñ–∞–ª–æ–≥, –Ω–µ –æ—Ç—Ä–∏–º–∞–≤—à–∏ —Ä–µ–∞–ª—å–Ω–æ—ó –¥–æ–ø–æ–º–æ–≥–∏, –∞–ª–µ –Ω–µ –≤–ª–∞—à—Ç–æ–≤—É—î —Å–∫–∞–Ω–¥–∞–ª.
        –ø—Ä–∏–∫–ª–∞–¥ –∑ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—é: –ö–ª—ñ—î–Ω—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–≤—ñ—á–ª–∏–≤–∏–π, –∫–∞–∂–µ ¬´–¥—è–∫—É—é¬ª, –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ—ó –∞–≥—Ä–µ—Å—ñ—ó. –ê–ª–µ –ø–æ 
        —Ñ–∞–∫—Ç—É –≤—ñ–Ω –∑–¥–∞—î—Ç—å—Å—è, –±–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–¥–∞–≤ —Ç–µ—Ö–Ω—ñ—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ, –∞–ª–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–µ –¥–ª—è –∂–∏–≤–æ—ó 
        –ª—é–¥–∏–Ω–∏ —Ä—ñ—à–µ–Ω–Ω—è (–ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏–≤ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏).

        –ö–ª—ñ—î–Ω—Ç: –î–æ–±—Ä–∏–π –≤–µ—á—ñ—Ä. –£ –º–µ–Ω–µ —á–æ–º—É—Å—å –Ω–µ –ø—ñ–¥—Ç—è–≥—É—î—Ç—å—Å—è —ñ—Å—Ç–æ—Ä—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å –∑–∞ –º–∏–Ω—É–ª–∏–π —Ä—ñ–∫, —Ö–æ—á–∞ —è —Ç–æ—á–Ω–æ 
        –∫—É–ø—É–≤–∞–ª–∞ —É –≤–∞—Å.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–æ–±—Ä–∏–π –≤–µ—á—ñ—Ä, –Ü—Ä–∏–Ω–æ! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. –©–æ–± –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó, –≤–∞–º 
        –ø–æ—Ç—Ä—ñ–±–Ω–æ: 1) –í–∏–π—Ç–∏ –∑ –∞–∫–∞—É–Ω—Ç—É. 2) –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à —Ç–∞ —Ñ–∞–π–ª–∏ cookie –≤–∞—à–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞ –∑–∞ –≤–µ—Å—å —á–∞—Å. 
        3) –ó–∞–π—Ç–∏ —á–µ—Ä–µ–∑ —Ä–µ–∂–∏–º –Ü–Ω–∫–æ–≥–Ω—ñ—Ç–æ. 4) –Ø–∫—â–æ –Ω–µ –¥–æ–ø–æ–º–æ–∂–µ ‚Äî –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∏–ø–∏—Å–∫—É –∑ –±–∞–Ω–∫—É –∑–∞ –º–∏–Ω—É–ª–∏–π —Ä—ñ–∫ 
        —ñ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–∞–º –Ω–∞ –ø–æ—à—Ç—É support@karibo.ua –∑ —Ç–µ–º–æ—é "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó", —ñ –º–∏ –≤—Ä—É—á–Ω—É –ø—ñ–¥—Ç—è–≥–Ω–µ–º–æ 
        —á–µ–∫–∏ –ø—Ä–æ—Ç—è–≥–æ–º 5 —Ä–æ–±–æ—á–∏—Ö –¥–Ω—ñ–≤.
        
        –ö–ª—ñ—î–Ω—Ç: –û–≥–æ, —Ü–µ –¥—É–∂–µ –±–∞–≥–∞—Ç–æ –¥—ñ–π –∑–∞—Ä–∞–¥–∏ —Å–ø–∏—Å–∫—É –∑–∞–º–æ–≤–ª–µ–Ω—å...
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –¢–∞–∫—ñ –≤–∏–º–æ–≥–∏ –Ω–∞—à–æ—ó —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑–ø–µ–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —Å—Ç–∞—Ä–∏—Ö –±–∞–∑ –¥–∞–Ω–∏—Ö. –ß–µ–∫–∞—î–º–æ –Ω–∞ –≤–∞—à–æ–≥–æ 
        –ª–∏—Å—Ç–∞!
        
        –ö–ª—ñ—î–Ω—Ç: –Ø –∑—Ä–æ–∑—É–º—ñ–ª–∞. –î—è–∫—É—é –∑–∞ —Ç–∞–∫—É –¥–µ—Ç–∞–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ú–∞–±—É—Ç—å, —è –ø—Ä–æ—Å—Ç–æ –æ–±—ñ–π–¥—É—Å—è –±–µ–∑ —Ü—ñ—î—ó —ñ—Å—Ç–æ—Ä—ñ—ó, 
        —Ü–µ –∑–∞–π–º–µ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –º–æ–≥–æ —á–∞—Å—É. –ù–∞ –≤—Å–µ –¥–æ–±—Ä–µ.
    """,
    "conflict_case": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –ö–ª—ñ—î–Ω—Ç –∑ —Å–∞–º–æ–≥–æ –ø–æ—á–∞—Ç–∫—É –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–∞–ø—Å, –∑–Ω–∞–∫–∏ –æ–∫–ª–∏–∫—É, –º–æ–∂–ª–∏–≤–æ –ª–µ–≥–∫—ñ –æ–±—Ä–∞–∑–∏.
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ù–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–∞—Å–ø–æ–∫–æ—ó—Ç–∏, –∞–ª–µ –∫–ª—ñ—î–Ω—Ç –Ω–µ —Å–ª—É—Ö–∞—î –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤.
        –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–ª—ñ—î–Ω—Ç –∫–∏–¥–∞—î —Å–ª—É—Ö–∞–≤–∫—É –∞–±–æ –ø–æ–≥—Ä–æ–∂—É—î –ø—ñ—Ç–∏ –¥–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤. –ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤–∏—Ä—ñ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ –µ–º–æ—Ü—ñ—ó.
        –ù–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—å: –ñ–æ–¥–Ω–æ–≥–æ –∫–∞–ø—Å—É, –∂–æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫—É –æ–∫–ª–∏–∫—É —á–∏ –º–∞—Ç—é–∫—ñ–≤. –•–æ–ª–æ–¥–Ω–∏–π, —é—Ä–∏–¥–∏—á–Ω–æ-–≤–∏–≤–∞–∂–µ–Ω–∏–π 
        –∫–æ–Ω—Ñ–ª—ñ–∫—Ç. –ö–ª—ñ—î–Ω—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–ø–æ–∫—ñ–π–Ω–∏–π, –∞–ª–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∏–π –¥–ª—è –±—ñ–∑–Ω–µ—Å—É.

        –ö–ª—ñ—î–Ω—Ç: –í—ñ—Ç–∞—é. –ó –º–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É –±—É–ª–æ —Å–ø–∏—Å–∞–Ω–æ 150 –≥—Ä–∏–≤–µ–Ω—å –∑–∞ –ø–æ—Å–ª—É–≥—É, —è–∫—É —è –¥–µ–∞–∫—Ç–∏–≤—É–≤–∞–≤ 12 —á–∏—Å–ª–∞.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–æ–±—Ä–∏–π –¥–µ–Ω—å, –°—Ç–∞–Ω—ñ—Å–ª–∞–≤–µ! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. –î–æ–∑–≤–æ–ª—å—Ç–µ –º–µ–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏. –î—ñ–π—Å–Ω–æ, 
        –≤–∏ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ –∫–Ω–æ–ø–∫—É –¥–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—ó, –∞–ª–µ –∑–∞ —É–º–æ–≤–∞–º–∏ –¥–æ–≥–æ–≤–æ—Ä—É –æ—Ñ–µ—Ä—Ç–∏ (–ø. 4.2), —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è –Ω–∞–±—É–≤–∞—î 
        —á–∏–Ω–Ω–æ—Å—Ç—ñ –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É. –¢–æ–º—É —Å–ø–∏—Å–∞–Ω–Ω—è –∫–æ—Ä–µ–∫—Ç–Ω–µ.
        
        –ö–ª—ñ—î–Ω—Ç: –í–∞—à –ø—É–Ω–∫—Ç 4.2 —Å—É–ø–µ—Ä–µ—á–∏—Ç—å –ó–∞–∫–æ–Ω—É –£–∫—Ä–∞—ó–Ω–∏ –ø—Ä–æ –∑–∞—Ö–∏—Å—Ç –ø—Ä–∞–≤ —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤. –Ø –Ω–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞–≤—Å—è 
        –ø–æ—Å–ª—É–≥–æ—é. –ù–∞–¥–∞–π—Ç–µ –º–µ–Ω—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –≤–∞—à–æ–≥–æ —é—Ä–∏–¥–∏—á–Ω–æ–≥–æ –≤—ñ–¥–¥—ñ–ª—É —Ç–∞ —é—Ä–∏–¥–∏—á–Ω—É –∞–¥—Ä–µ—Å—É –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è 
        –¥–æ—Å—É–¥–æ–≤–æ—ó –ø—Ä–µ—Ç–µ–Ω–∑—ñ—ó.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –°—Ç–∞–Ω—ñ—Å–ª–∞–≤–µ, —è —Ä–æ–∑—É–º—ñ—é, —â–æ —Å–∏—Ç—É–∞—Ü—ñ—è –Ω–µ–ø—Ä–∏—î–º–Ω–∞. –Ø–∫ –≤–∏–Ω—è—Ç–æ–∫, —è –º–æ–∂—É –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –≤–∞–º 
        –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ 200 –≥—Ä–∏–≤–µ–Ω—å –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω—É –ø–æ–∫—É–ø–∫—É, —â–æ–± –∫–æ–º–ø–µ–Ω—Å—É–≤–∞—Ç–∏...
        
        –ö–ª—ñ—î–Ω—Ç: –ú–µ–Ω—ñ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –≤–∞—à—ñ –ø–æ–¥–∞—á–∫–∏. –ú–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–µ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –º–æ—ó—Ö –∫–æ—à—Ç—ñ–≤ –∞–±–æ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —é—Ä–∏—Å—Ç—ñ–≤. 
        –î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–æ. –ß–µ–∫–∞—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.
    """,
    "agent_mistake_tone": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –ö–ª—ñ—î–Ω—Ç —Å—Ç–∞–≤–∏—Ç—å –∑–≤–∏—á–∞–π–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è.
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–≤–µ—Ä—Ö–Ω—å–æ, –≥—Ä—É–±–æ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–∞—Å–∏–≤–Ω–æ-–∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π —Ç–æ–Ω (rude_tone).
        –ö–ª—ñ—î–Ω—Ç: –®–æ–∫–æ–≤–∞–Ω–∏–π —Ç–∞–∫–æ—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é, —Ä–æ–±–∏—Ç—å –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è.
        
        –ù–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—å: –¢–æ–∫—Å–∏—á–Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ñ—Å—Ç—å. –û–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ —Ö–∞–º–∏—Ç—å, –≤—ñ–Ω –Ω–∞–≤–ø–∞–∫–∏ ‚Äî –∑–∞–Ω–∞–¥—Ç–æ —Ä–∞–¥—ñ—Å–Ω–∏–π, 
        –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ–º–æ–¥–∑—ñ —Ç–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ —à–∞–±–ª–æ–Ω–∏ –≤ —Å–∏—Ç—É–∞—Ü—ñ—ó, –¥–µ –∫–ª—ñ—î–Ω—Ç –∑–∞–∑–Ω–∞–≤ —Å–µ—Ä–π–æ–∑–Ω–æ–≥–æ —Å—Ç—Ä–µ—Å—É —á–∏ –≤—Ç—Ä–∞—Ç–∏.

        –ö–ª—ñ—î–Ω—Ç: –î–æ–±—Ä–∏–π –¥–µ–Ω—å. –ú—ñ–π –∞–∫–∞—É–Ω—Ç —â–æ–π–Ω–æ –∑–ª–∞–º–∞–ª–∏ —ñ —Ö—Ç–æ—Å—å –≤–∏—Ç—Ä–∞—Ç–∏–≤ —É—Å—ñ –º–æ—ó –±–æ–Ω—É—Å–∏ –Ω–∞ —è–∫—ñ—Å—å –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª—ñ 
        –ø—ñ–¥–ø–∏—Å–∫–∏! –©–æ –º–µ–Ω—ñ —Ä–æ–±–∏—Ç–∏?!
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–æ–±—Ä–∏–π –¥–µ–Ω—å, –°–æ—Ñ—ñ—î! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. ü§© –û–≥–æ, –∑–≤—É—á–∏—Ç—å —è–∫ —Å–ø—Ä–∞–≤–∂–Ω—è –ø—Ä–∏–≥–æ–¥–∞! –ê–ª–µ 
        –Ω–µ —Ö–≤–∏–ª—é–π—Ç–µ—Å—è, –º–∏ –∑ —Ä–∞–¥—ñ—Å—Ç—é –¥–æ–ø–æ–º–æ–∂–µ–º–æ –≤–∞–º —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è –∑ —Ü–∏–º –ø–∏—Ç–∞–Ω–Ω—è–º! 
        –ö–ª—ñ—î–Ω—Ç: –Ø–∫–∞ –ø—Ä–∏–≥–æ–¥–∞? –£ –º–µ–Ω–µ –≤–∫—Ä–∞–ª–∏ –≥—Ä–æ—à—ñ –∑ –∫–∞—Ä—Ç–∫–∏, —è–∫–∞ —Ç—É–¥–∏ –ø—ñ–¥–≤'—è–∑–∞–Ω–∞! –ó–∞–±–ª–æ–∫—É–π—Ç–µ –∞–∫–∞—É–Ω—Ç –Ω–µ–≥–∞–π–Ω–æ!
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ß—É–¥–æ–≤–∞ —ñ–¥–µ—è! üöÄ –ú–∏ –∑–∞–≤–∂–¥–∏ –¥–±–∞—î–º–æ –ø—Ä–æ –≤–∞—à—É –±–µ–∑–ø–µ–∫—É. –ó–∞—Ä–∞–∑ —è –Ω–∞–¥—ñ—à–ª—é –≤–∞–º —Ñ–æ—Ä–º—É –Ω–∞ 
        –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É, —Ü–µ –∑–∞–π–º–µ –≤—Å—å–æ–≥–æ –ø–∞—Ä—É —Ö–≤–∏–ª–∏–Ω–æ—á–æ–∫ –≤–∞—à–æ–≥–æ —á–∞—Å—É! üòä
        
        –ö–ª—ñ—î–Ω—Ç: –í–∏ –∑–Ω—É—â–∞—î—Ç–µ—Å—å –∑ –º–µ–Ω–µ? –Ø–∫—ñ —Å–º–∞–π–ª–∏–∫–∏, —É –º–µ–Ω–µ –≥—Ä–æ—à—ñ –∫—Ä–∞–¥—É—Ç—å –ø—Ä—è–º–æ –∑–∞—Ä–∞–∑!
    """,
    "agent_mistake_logic": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –ö–ª—ñ—î–Ω—Ç –æ–ø–∏—Å—É—î –ø—Ä–æ–±–ª–µ–º—É.
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–∞—î –ø–æ—Ä–∞–¥—É, —è–∫–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ —Å—Ç–æ—Å—É—î—Ç—å—Å—è —Ç–µ–º–∏ (incorrect_info) –∞–±–æ —ñ–≥–Ω–æ—Ä—É—î –ø—Ä—è–º–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (ignored_question).
        –ö–ª—ñ—î–Ω—Ç: –í–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä –π–æ–≥–æ –Ω–µ —Å–ª—É—Ö–∞—î.
        –ù–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—å: –û–ø–µ—Ä–∞—Ç–æ—Ä –¥–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—É –±–∞–∑–æ–≤—É –ø–æ—Ä–∞–¥—É, –∞–ª–µ –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–≥–Ω–æ—Ä—É—î —Ç–æ–π —Ñ–∞–∫—Ç, —â–æ –∫–ª—ñ—î–Ω—Ç —É 
        —Å–≤–æ—î–º—É –ø–µ—Ä—à–æ–º—É –∂ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ –Ω–∞–ø–∏—Å–∞–≤, —â–æ –í–ñ–ï —Ü–µ –∑—Ä–æ–±–∏–≤. –¶–µ —Ç–∏–ø–æ–≤–∞ –ø–æ–º–∏–ª–∫–∞ –Ω–µ—É–≤–∞–∂–Ω–∏—Ö –∞–≥–µ–Ω—Ç—ñ–≤, —è–∫–∏—Ö 
        "—Ç—è–≥–Ω–µ" –ø–æ —Å–∫—Ä–∏–ø—Ç—É.

        –ö–ª—ñ—î–Ω—Ç: –ü—Ä–∏–≤—ñ—Ç. –î–æ–¥–∞—Ç–æ–∫ –Ω–∞ iOS –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è. –Ø –≤–∂–µ –≤–∏–¥–∞–ª—è–≤ –π–æ–≥–æ, –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞–≤ –Ω–∞–Ω–æ–≤–æ –∑ 
        App Store, –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–≤ —Ç–µ–ª–µ—Ñ–æ–Ω —ñ –Ω–∞–≤—ñ—Ç—å –æ–Ω–æ–≤–ª—é–≤–∞–≤ —Å–∞–º—É iOS –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó. –ù—ñ—á–æ–≥–æ –Ω–µ 
        –¥–æ–ø–æ–º–∞–≥–∞—î, –ø—Ä–æ—Å—Ç–æ –±—ñ–ª–∏–π –µ–∫—Ä–∞–Ω.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ü—Ä–∏–≤—ñ—Ç, –ê–Ω—Ç–æ–Ω–µ! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. –ë–∞—á—É –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É. –£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∑–∞–∑–≤–∏—á–∞–π 
        –¥–æ–ø–æ–º–∞–≥–∞—î –ø—Ä–æ—Å—Ç–∞ –ø–µ—Ä–µ–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ, –±—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–¥–∞–ª–∏—Ç–∏ –π–æ–≥–æ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–Ω–æ–≤—É.
        
        –ö–ª—ñ—î–Ω—Ç: –í–∏ –≤–∑–∞–≥–∞–ª—ñ —á–∏—Ç–∞–ª–∏ –º–æ—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è? –Ø –∂ —â–æ–π–Ω–æ –Ω–∞–ø–∏—Å–∞–≤, —â–æ –≤–∂–µ —Ä–æ–±–∏–≤ —Ü–µ.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –¢–∞–∫–æ–∂ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –Ω–∞ –≤–∞—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –æ—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.
        
        –ö–ª—ñ—î–Ω—Ç: –ö–ª–∏—á—Ç–µ —Å—Ç–∞—Ä—à–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞. –†–æ–∑–º–æ–≤–∞ –∑ –±–æ—Ç–æ–º –±—É–ª–∞ –± –±—ñ–ª—å—à –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—é.
    """,
    "unsolvable_policy": """
        –°–∏—Ç—É–∞—Ü—ñ—è: –ö–ª—ñ—î–Ω—Ç –≤–∏–º–∞–≥–∞—î —Ç–µ, —â–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–æ—à—Ç—ñ–≤ —á–µ—Ä–µ–∑ —Ä—ñ–∫ –∞–±–æ –¥–æ—Å—Ç—É–ø –¥–æ —á—É–∂–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É).
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –í–≤—ñ—á–ª–∏–≤–æ, –∞–ª–µ —Ç–≤–µ—Ä–¥–æ –í–Ü–î–ú–û–í–õ–Ø–Ñ, –ø–æ—Å–∏–ª–∞—é—á–∏—Å—å –Ω–∞ –ø—Ä–∞–≤–∏–ª–∞. –¶–µ –ù–ï –ø–æ–º–∏–ª–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
        –ö–ª—ñ—î–Ω—Ç: –ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–µ–∑–∞–¥–æ–≤–æ–ª–µ–Ω–∏–º —Ñ–∞–∫—Ç–æ–º –≤—ñ–¥–º–æ–≤–∏, –∞–ª–µ –ø—Ä–µ—Ç–µ–Ω–∑—ñ–π –¥–æ —Ä–æ–±–æ—Ç–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –º–∞—î (–∞–±–æ –∑–º–∏—Ä–∏–≤—Å—è).
        –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ø–∫—ñ—Å–Ω–∞ —Ä–æ–±–æ—Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø—Ä–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞.
        
        –ù–µ–æ—á–µ–≤–∏–¥–Ω—ñ—Å—Ç—å: –ü–æ–ª—ñ—Ç–∏–∫–∞ –∫–æ–º–ø–∞–Ω—ñ—ó –¥—ñ–π—Å–Ω–æ –≤–∏–≥–ª—è–¥–∞—î —Ç—É–ø–æ—é —ñ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—é –≤ –¥–∞–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ. 
        –û–ø–µ—Ä–∞—Ç–æ—Ä –≤–∏—è–≤–ª—è—î —â–∏—Ä—É –µ–º–ø–∞—Ç—ñ—é, –ø–æ–≥–æ–¥–∂—É—î—Ç—å—Å—è –∑ –∫–ª—ñ—î–Ω—Ç–æ–º, —â–æ —Ü–µ –Ω–µ–∑—Ä—É—á–Ω–æ, –∞–ª–µ —Å–∏—Å—Ç–µ–º–∞ —Ñ—ñ–∑–∏—á–Ω–æ –Ω–µ 
        –¥–∞—î –π–æ–º—É –Ω—ñ—á–æ–≥–æ –∑—Ä–æ–±–∏—Ç–∏.
        
        –ö–ª—ñ—î–Ω—Ç: –î–æ–±—Ä–∏–π –¥–µ–Ω—å. –Ø –≤–∏–π—à–ª–∞ –∑–∞–º—ñ–∂ —ñ –∑–º—ñ–Ω–∏–ª–∞ –ø—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ –ø–æ—à—Ç—É. –ú–µ–Ω—ñ —Ç—Ä–µ–±–∞ –∑–º—ñ–Ω–∏—Ç–∏ –≥–æ–ª–æ–≤–Ω–∏–π email 
        –≤ –∞–∫–∞—É–Ω—Ç—ñ, –±–æ –¥–æ —Å—Ç–∞—Ä–æ—ó –ø–æ—à—Ç–∏ —è –±—ñ–ª—å—à–µ –Ω–µ –º–∞—é –¥–æ—Å—Ç—É–ø—É.
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –î–æ–±—Ä–∏–π –¥–µ–Ω—å, –û–ª–µ–Ω–æ! –í–∞—Å –≤—ñ—Ç–∞—î –∫–æ–º–ø–∞–Ω—ñ—è –ö–ê–†–ò–ë–û. –í—ñ—Ç–∞—é –≤–∞—Å —ñ–∑ —Ü—ñ—î—é —á—É–¥–æ–≤–æ—é –ø–æ–¥—ñ—î—é! –©–æ–¥–æ 
        –≤–∞—à–æ–≥–æ –∑–∞–ø–∏—Ç—É: –Ω–∞ –∂–∞–ª—å, –Ω–∞—à–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ —Ç–∞–∫, —â–æ email —î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º 
        —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º. –ô–æ–≥–æ —Ç–µ—Ö–Ω—ñ—á–Ω–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏.
        
        –ö–ª—ñ—î–Ω—Ç: –¢–æ–±—Ç–æ —è–∫? –ú–µ–Ω—ñ —â–æ, —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –∞–∫–∞—É–Ω—Ç? –ê —è–∫ –∂–µ –º–æ—è –∑–Ω–∏–∂–∫–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç—ñ 15%, —è–∫—É —è –∑–±–∏—Ä–∞–ª–∞
        —Ç—Ä–∏ —Ä–æ–∫–∏, —ñ –≤—Å—è —ñ—Å—Ç–æ—Ä—ñ—è –ø–æ–∫—É–ø–æ–∫?
        
        –û–ø–µ—Ä–∞—Ç–æ—Ä: –ú–µ–Ω—ñ –¥—É–∂–µ –ø—Ä–∏–∫—Ä–æ, —ñ —è —Ü—ñ–ª–∫–æ–º —Ä–æ–∑—É–º—ñ—é –≤–∞—à–µ –æ–±—É—Ä–µ–Ω–Ω—è. –¶–µ –¥—ñ–π—Å–Ω–æ –≤–∫—Ä–∞–π –Ω–µ–∑—Ä—É—á–Ω–∞ —Å–∏—Å—Ç–µ–º–∞. –ê–ª–µ
        —è —Ñ—ñ–∑–∏—á–Ω–æ –Ω–µ –º–∞—é –∫–Ω–æ–ø–∫–∏ –∑–º—ñ–Ω–∏ –ø–æ—à—Ç–∏. –Ñ–¥–∏–Ω–∏–π –≤–∏—Ö—ñ–¥ ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –∞–∫–∞—É–Ω—Ç. –Ø –º–æ–∂—É –≤—Ä—É—á–Ω—É –Ω–∞—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤–∞–º 1000 –±–æ–Ω—É—Å—ñ–≤ –Ω–∞ –Ω–æ–≤–∏–π –∞–∫–∞—É–Ω—Ç —è–∫ –≤–∏–±–∞—á–µ–Ω–Ω—è –∑–∞ —Ü—é —Å–∏—Ç—É–∞—Ü—ñ—é.
        
        –ö–ª—ñ—î–Ω—Ç: –¶–µ –ø—Ä–æ—Å—Ç–æ —Å–º—ñ—à–Ω–æ –≤ 2026 —Ä–æ—Ü—ñ –Ω–µ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ—à—Ç—É... –ì–∞—Ä–∞–∑–¥, –¥–∞–≤–∞–π—Ç–µ –≤–∞—à—ñ 
        –±–æ–Ω—É—Å–∏ –Ω–∞ –Ω–æ–≤–∏–π –∞–∫–∞—É–Ω—Ç, —â–æ –≤–∂–µ —Ä–æ–±–∏—Ç–∏.
    """
}

agents_names = ["–ú–∞–∫—Å–∏–º", "–û–ª–µ–Ω–∞", "–î–º–∏—Ç—Ä–æ", "–ê–ª—ñ–Ω–∞", "–°–µ—Ä–≥—ñ–π"]

def generate_dialogue(intent, scenario_key):
    detailed_instruction = scenario_instructions[scenario_key]

    system_instruction = f"""
    –¢–∏ ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏—Ö –¥—ñ–∞–ª–æ–≥—ñ–≤ –º—ñ–∂ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º —Ç–µ—Ö–ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Ç–∞ –∫–ª—ñ—î–Ω—Ç–æ–º.
    –¢–≤–æ—è –∑–∞–¥–∞—á–∞: –Ω–∞–ø–∏—Å–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥ –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–∞ —Å–∞–ø–æ—Ä—Ç-–∞–≥–µ–Ω—Ç–æ–º –∫–æ–º–ø–∞–Ω—ñ—ó "–ö–ê–†–ò–ë–û".
    –ù–ï –±–µ—Ä–∏ —è–∫ —à–∞–±–ª–æ–Ω –ø—Ä–∏–∫–ª–∞–¥–∏, —è–∫—ñ —è –≤–∫–∞–∑–∞–ª–∞ –≤ {scenario_instructions}, –≤–æ–Ω–∏ —Ç–∞–º —à–æ–± –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ç–æ–±—ñ –∑–º–æ–¥–µ–ª—é–≤–∞—Ç–∏
    –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—É —Å–∏—Ç—É–∞—Ü—ñ—é.
    
    –§–û–†–ú–ê–¢–£–í–ê–ù–ù–Ø:
    –î–ª—è –ø–æ–ª—è 'role' –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Ç—ñ–ª—å–∫–∏ –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–Ω—è: "–ö–ª—ñ—î–Ω—Ç" –∞–±–æ "–û–ø–µ—Ä–∞—Ç–æ—Ä". 
    –Ü–º'—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ ({agents_names}) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –¢–Ü–õ–¨–ö–ò –≤ —Å–∞–º–æ–º—É —Ç–µ–∫—Å—Ç—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (—É –ø–æ–ª—ñ 'text'), 
    –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –ø—Ä–∏ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—ñ.

    –ü–ï–†–°–û–ù–ê–õ–Ü–ó–ê–¶–Ü–Ø:
    1. –ö–ª—ñ—î–Ω—Ç: –ñ–∏–≤–∞ –ª—é–¥–∏–Ω–∞. –ú–æ–∂–µ –ø–∏—Å–∞—Ç–∏ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—É—Ä–∂–∏–∫, —Å–ª–µ–Ω–≥, –ø—Ä–æ–ø—É—Å–∫–∞—Ç–∏ –∫–æ–º–∏.
    –ü–æ–º–∏–ª–∫–∏ –º–∞—é—Ç—å –±—É—Ç–∏ –ø—Ä–∏—Ä–æ–¥–Ω–∏–º–∏ (–¥—Ä—É–∫–∞—Ä—Å—å–∫—ñ –æ–≥—Ä—ñ—Ö–∏), –∞ –Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —à—É–º
    2. –û–ø–µ—Ä–∞—Ç–æ—Ä ({agents_names}): –î–æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è —Å–∫—Ä–∏–ø—Ç—ñ–≤, –∞–ª–µ –Ω–µ —Ä–æ–±–æ—Ç–∏–∑–æ–≤–∞–Ω–æ. "–†–æ–±–æ—Ç–∏–∑–æ–≤–∞–Ω–æ" - –æ–∑–Ω–∞—á–∞—î,
    —â–æ –Ω–µ –ø—Ä–æ—è–≤–ª—è—î –µ–º–ø–∞—Ç—ñ—ó, –ø–∏—à–µ —Å—É—Ö—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Ç–∞ –Ω–µ –ø–æ–∫–∞–∑—É—î –∫–ª—ñ—î–Ω—Ç—É, —à–æ –≤—ñ–Ω –¥–ª—è –Ω—å–æ–≥–æ –≤–∞–∂–ª–∏–≤–∏–π.

    –ó–ê–ë–û–†–û–ù–ò:
    - –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Ñ—Ä–∞–∑—É "–Ø—Å–Ω–æ, –¥—è–∫—É—é" —É –∫–æ–∂–Ω–æ–º—É –¥—ñ–∞–ª–æ–∑—ñ —Ç–∞ –∫–æ–ª–∏ –¥—ñ–∞–ª–æ–≥ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è, –Ω–∞–º–∞–≥–∞–π—Å—è –º–µ–Ω—à–µ 
    –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ
    - –ù–µ —Ä–æ–±–∏ –¥—ñ–∞–ª–æ–≥–∏ –∑–∞–Ω–∞–¥—Ç–æ "—Ä–æ–±–æ—Ç–∏–∑–æ–≤–∞–Ω–∏–º–∏", –Ω–µ –∑–∞–±—É–≤–∞–π —â–æ –∫–ª—ñ—î–Ω—Ç —Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä - –∂–∏–≤—ñ –ª—é–¥–∏.
    """

    prompt = f"""
    –¢–ï–ú–ê –ó–í–ï–†–ù–ï–ù–ù–Ø: {intent}
    –°–¶–ï–ù–ê–†–Ü–ô: {scenario_key}
    –î–ï–¢–ê–õ–Ü –°–¶–ï–ù–ê–†–Ü–Æ: {detailed_instruction}

    –°–¢–†–£–ö–¢–£–†–ê:
    1. –ü–æ—á–∞—Ç–æ–∫: –∫–ª—ñ—î–Ω—Ç –ø–∏—à–µ –∑ —Å–≤–æ—î—é –ø—Ä–æ–±–ª–µ–º–æ—é - –º–∞—î –ø–æ—á–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥
    1. –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è: '–í—ñ—Ç–∞—é, —è {agents_names}, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –ö–ê–†–ò–ë–û. –ü—ñ–¥–∫–∞–∂—ñ—Ç—å —è–∫ –¥–æ –í–∞—Å –º–æ–∂–Ω–∞ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—å. 
    ' (–∞–±–æ –≤–∞—Ä—ñ–∞—Ü—ñ—ó) –æ–±–æ–≤'–∑–∫–æ–≤–æ –ø–æ–≤–∏–Ω–µ–Ω —Å–µ–±–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Ç–∞ –∑–≤—ñ–¥–∫–∏ –≤—ñ–Ω. —ñ –ø–æ—á–∏–Ω–∞—î –¥–æ–ø–æ–º–∞–≥–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç—É
    2. –î–æ–≤–∂–∏–Ω–∞: 5-9 —Ä–µ–ø–ª—ñ–∫ (–∑—Ä–æ–±–∏ –¥—ñ–∞–ª–æ–≥ –∑–º—ñ—Å—Ç–æ–≤–Ω–∏–º).
    3. –ö–æ–Ω—Ç–µ–∫—Å—Ç: –¶–µ —á–∞—Ç —É –º–µ—Å–µ–Ω–¥–∂–µ—Ä—ñ.
    """

    config = types.GenerateContentConfig(
        system_instruction=system_instruction,
        temperature=1.0,
        response_mime_type="application/json",
        response_schema=DialogueResponse,
    )

    for attempt in range(3):
        try:
            response = client.models.generate_content(
                model='gemini-2.5-flash',
                contents=prompt,
                config=config
            )

            parsed_data = json.loads(response.text)
            return parsed_data

        except Exception as e:
            print(f"–ü–û–ú–ò–õ–ö–ê: {intent} + {scenario_key} (–°–ø—Ä–æ–±–∞ {attempt + 1}): {e}")
            time.sleep(2)

    print(f"–Ω–µ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è {intent} + {scenario_key}. –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ.")
    return None

if __name__ == "__main__":
    start_time = time.time()
    print(" –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞—Ç–∞—Å–µ—Ç—É...")

    tasks = []

    for intent in intents:
        for scenario in scenario_instructions.keys():
            tasks.append((intent, scenario))

    random.shuffle(tasks)

    tasks = tasks[:25]

    with ThreadPoolExecutor(max_workers=5) as executor:
        results = list(executor.map(lambda x: generate_dialogue(x[0], x[1]), tasks))

    dataset = [res for res in results if res]

    with open("dataset.json", "w", encoding="utf-8") as file:
        json.dump(dataset, file, ensure_ascii=False, indent=4)

    print(f"–ì–æ—Ç–æ–≤–æ! –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ {len(dataset)} –¥—ñ–∞–ª–æ–≥—ñ–≤. –ß–∞—Å: {time.time() - start_time:.2f}—Å")